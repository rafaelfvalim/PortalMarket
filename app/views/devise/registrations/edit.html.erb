<%= render 'layouts/messages' %>

<div class="wrapper wrapper-content animated fadeIn">
  <h3>Edit <%= resource_name.to_s.humanize %></h3>
  <div class="row">
    <div class="col-lg-12">
      <% unless @current_user.avatar_url.present? %>
          <a href='#' data-toggle='modal' data-target='#avatar_modal'>
            <img class="img-circle" src="<%= image_url 'avatar-n-60x60.png' %>"/>
          </a>
      <% else %>
          <a href='#' data-toggle='modal' data-target='#avatar_modal'>
            <img class="img-circle" src="<%= image_url @current_user.avatar.circle_avatar.url.to_s %>"/>
          </a>
          <br>
          <%= link_to remove_avatar_users_path(id: @current_user.id) do %>
              <i class="fa fa-trash"></i> Remove
          <% end %>
      <% end %>
    </div>
  </div>

  <%= simple_form_for(resource, :as => resource_name, :url => registration_path(resource_name), :html => {:method => :put, :role => 'form', id: 'edit_profile_form'}) do |f| %>
      <%= f.fields_for :member, resource.member do |m| %>
          <div class="row">
            <div class="col-lg-6 ">
              <%= m.input :member_name, label: 'Name:', :autofocus => true, class: 'form-control' %>
            </div>
            <div class="col-lg-6 ">
              <%= m.input :member_last_name, label: 'Last Name:', class: 'form-control' %>
            </div>
          </div>
          <div class="row">
            <div class="col-lg-6 ">
              <%= m.input :phone_number, class: 'form-control', label: 'Phone:', input_html: {data: {mask: '(99) 9999-9999'}} %>
            </div>
            <div class="col-lg-6 ">
              <%= m.input :cellphone_number, class: 'form-control', label: 'Cell Phone:', input_html: {data: {mask: '(99) 99999-9999'}} %>
            </div>
          </div>
          <div class="row">
            <div class="col-lg-6 ">
              <%= m.input :cpf, class: 'form-control', label: 'CPF:', input_html: {data: {mask: '999.999.999-99'}} %>
            </div>
            <% unless current_user.member.master_user_id? %>
                <div class="col-lg-6 ">
                  <%= m.input :cnpj, class: 'form-control', label: 'CNPJ:', input_html: {data: {mask: '99.999.999/9999-99'}} %>
                </div>
            <% end %>
          </div>
          <% if current_user.is_contributor? %>
              <div class="row">
                <div class="col-lg-6 ">
                  <%= m.input :bank_id, collection: all_banks, label_method: :description, label: "Choose Bank:", include_blank: 'Please Select..' %>
                </div>
              </div>
              <div class="row">
                <div class="col-lg-1 ">
                  <%= m.input :bank_ag, label: 'Ag:', class: 'form-control' %>
                </div>
                <div class="col-lg-4 ">
                  <%= m.input :bank_cc, label: 'Cc:', class: 'form-control' %>
                </div>
                <div class="col-lg-1">
                  <%= m.input :bank_cc_digit, label: 'Digit:', class: 'form-control' %>
                </div>
              </div>
          <% elsif current_user.is_customer? %>
              <div class="row">
                <div class="col-lg-6 ">
                  <%= m.input :company_name, label: 'Company Name:' %>
                </div>
              </div>
          <% end %>
      <% end %>
      <div class="row">
        <div class="col-lg-6 ">
          <%= f.input :email, class: 'form-control' %>
        </div>
      </div>
      <%= f.fields_for :address, @user.address do |address| %>
          <div class="row">
            <div class="col-lg-4">
              <%= address.input :zip_code, label: 'Digite seu CEP:', class: 'form-control' %>
            </div>
            <div class="col-lg-2">
              <%= address.input :patio_type, label: 'Tipo Log:', class: 'form-control', input_html: {data: {cep: 'tipo_logradouro'}} %>
            </div>
            <div class="col-lg-4">
              <%= address.input :patio, label: 'Logradouro:', class: 'form-control', input_html: {data: {cep: 'logradouro'}} %>
            </div>
            <div class="col-lg-2">
              <%= address.input :number, label: 'Numero:', class: 'form-control' %>
            </div>
          </div>
          <div class="row">
            <div class="col-lg-6">
              <%= address.input :neighborhood, label: 'Bairro:', class: 'form-control', input_html: {data: {cep: 'bairro'}} %>
            </div>
            <div class="col-lg-6">
              <%= address.input :complement, label: 'Complemento:', class: 'form-control' %>
            </div>
          </div>
          <div class="row">
            <div class="col-lg-4">
              <%= address.input :city, label: 'Cidade:', class: 'form-control', input_html: {data: {cep: 'cidade'}} %>
            </div>
            <div class="col-lg-2">
              <%= address.input :state, label: 'Estado:', class: 'form-control', input_html: {data: {cep: 'uf'}} %>
            </div>
          </div>
      <% end %>
      <div class="row">
        <div class="col-lg-6 ">
          <% if devise_mapping.confirmable? && resource.pending_reconfirmation? %>
              <div>Currently waiting confirmation for: <%= resource.unconfirmed_email %></div>
          <% end %>
        </div>
      </div>
      <div class="row">
        <div class="col-lg-12">
          Leave these fields blank if you don't want to change your password
        </div>
      </div>
      <div class="row">
        <div class="col-lg-6">
          <%= f.input :password, class: 'form-control' %>
        </div>
        <div class="col-lg-6">
          <%= f.input :password_confirmation, class: 'form-control' %>
        </div>
      </div>
      <div class="row">
        <div class="col-lg-4"></div>
        <div class="col-lg-4">
          <p>You must enter your current password to make changes.</p>
          <%= f.input :current_password, class: 'form-control' %>
        </div>
        <div class="col-lg-4"></div>
      </div>
      <div class="row">
        <div class="col-lg-4"></div>
        <div class="col-lg-4 text-center">
          <%= f.submit 'Update', :class => 'btn btn-success btn-lock' %>
        </div>
        <div class="col-lg-4"></div>
      </div>
  <% end %>
  <div class="row">
    <div class="col-md-4"></div>
    <div class="col-md-4 text-center">
      <h3>Cancel Account</h3>

      <p>Unhappy? We'll be sad to see you go.</p>
      <%= button_to "Cancel my account", registration_path(resource_name), :data => {:confirm => "Are you sure?"}, :method => :delete, :class => 'btn btn-warning' %>
    </div>
    <div class="col-md-4"></div>
  </div>
  <br>
  <br>
</div>

<div id="avatar_modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <!-- Modal content-->
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">&times;</button>
        <h4 class="modal-title">Upload Avatar:</h4>
      </div>
      <div class="modal-body">
        <%= simple_form_for @current_user, url: upload_avatar_users_path(id: @current_user.id), html: {id: 'upload_avatar', method: :put, multipart: true} do |u| %>

            <div class="row">
              <div class="col-lg-12 thumbnail">
                <% unless @current_user.avatar_url.present? %>
                    <img class="img-circle" src="<%= image_url 'avatar-n-60x60.png' %>"/>
                <% else %>
                    <img class="img-circle" src="<%= image_url @current_user.avatar.circle_avatar.url.to_s %>"/>
                <% end %>
              </div>
            </div>
            <div class="row">
              <div class="col-lg-12 ">
                <%= u.file_field :avatar, class: 'form-control', onchange: "readURL(this);" %>
                <%= u.input :avatar_cache, as: :hidden %>
              </div>
            </div>
            <br>
            <div class="row">
              <div class="col-lg-12 ">
              <p>Imagem deve ser menor que 2MB <br>Formatos aceitos JPG, PNG, GIF</p>
              </div>
            </div>
            <br>
        <% end %>
      </div>
    </div>
  </div>
</div>
