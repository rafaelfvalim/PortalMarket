<div id="wrapper">
  <%= render 'layouts/side_bar_contributor' %>
  <div id="page-wrapper">
    <%= render 'layouts/messages' %>
    <%= form_tag('/carts', method: :post, remote: true) do %>
        <div class="row">
          <div class="col-md-6">
            <h3><%= @script.name %> </h3>
          </div>
          <div class="col-md-3">
            <h4>
              <strong><i class="fa fa-star"></i><i class="fa fa-star"></i><i class="fa fa-star"></i><i class="fa fa-star-half-o"></i><i class="fa fa-star-o"></i></strong>
            </h4>
            <h4><strong>
              <small>Price :</small>
              R$ <%= @price.value %></strong></h4>
          </div>
          <div class="col-md-3">
            <br>

            <div class="pull-rigth">
              <%= link_to 'Back', searches_path, class: 'btn btn-default' %>
              <%= button_tag(type: "submit", class: "btn btn-default", id: "submit_invoice", data: {confirm: 'Add item to cart?'}) do %>
                  <i class="fa fa-cart-plus"></i> Add To Cart
              <% end %>
            </div>
          </div>
        </div>
        <hr>
        <div class="row">
          <div class="col-md-6">
            <p>
              <strong>Cod:</strong>
              <%= @script.id %>
            </p>
            <br>

            <p>
              <strong>Definition:</strong>
              <%= @script.definition %>
            </p>
            <br>

            <p>
              <strong>Platform:</strong>
              <%= @script.platform %>
            </p>
            <br>

            <p>
              <strong>Industry:</strong>
              <%= @script.industry %>
            </p>
            <br>

            <p>
              <strong>Requeriments :</strong>
              <% if @script.requirements.size > 0 %>
                <ul>
                  <% @script.requirements.each do |requirement| %>
                      <li><%= requirement.requirement %></li>
                  <% end %>
                </ul>
            <% else %>
                <small>N/A</small>
            <% end %>
            </p>
            <p>
              <strong>Processos :</strong>

            <p>
              <% show_process_chain(@script.id).each do |process| %>
                  <%= build_list_chain(process, @script.id, false) %>
              <% end %>
            </p>
            </p>

          </div>
          <div class="col-md-6">
            <p>
              <strong>Description:</strong>
              <%= @script.description %>
            </p>
            <br>

            <p>
              <strong>Long text:</strong>
              <%= @script.long_text %>
            </p>
            <br>

            <p>
              <strong>Solution type:</strong>
              <%= @script.solution_type_id %>
            </p>
            <br>

            <p>
              <strong>Contributor :</strong>
              <% @script.members.each do |member| %>
                  <% if @script.members.size > 1 %>
                      <%= "#{member.member_name} #{ member.member_last_name}" %>,
                  <% else %>
                      <%= "#{member.member_name} #{ member.member_last_name}" %>
                  <% end %>
              <% end %>
            </p>

            <p>
              <strong>created at : <%= @script.created_at.to_s(:custom_datetime) %></strong>
            </p>
            <br>
            <% if @script.related_scripts.size > 0 %>
                <p>
                  <strong>Relateds Scripts :</strong>
                <ul>
                  <% @script.related_scripts.each do |related_script| %>
                      <% @related_script = Script.find_by id: related_script.script_id %>
                      <li><%= @related_script.name %></li>
                  <% end %>
                </ul>
                </p>
            <% end %>
            <br>
          </div>
          <%= hidden_field_tag 'cart[member_id]', current_user.member.id %>
          <%= hidden_field_tag 'cart[script_id]', @script.id %>
          <%= hidden_field_tag 'cart[price_id]', @price.id %>
          <%= hidden_field_tag 'cart[full_sale]', false %>
        </div>
        <hr>
        <div class="panel panel-default">
          <div class="panel-heading"><strong>To organization:</strong></div>
          <div class="panel-body">
            <div class="row">
              <div class="col-md-6">
                <label>Destination System Number:</label>
                <%= text_field_tag :system_number, nil, class: 'form-control' %>
              </div>
              <div class="col-md-6">
                <label>Organization Name:</label>
                <%= text_field_tag 'cart[organ]', nil, class: 'form-control' %>
              </div>
            </div>
            <br>
          </div>
        </div>
        <hr>
        <div class="panel panel-default">
          <div class="panel-heading">Paper:</div>
          <div class="row">
            <div class="col-md-12">
              <iframe src="<%= @script.pdf_file.url %>#toolbar=false&navpanes=0&scrollbar=0" width="100%" height="1075" frameborder="0"></iframe>
            </div>
          </div>
        </div>
    <% end %>
  </div>
</div>

<div id="workplace_modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <!-- Modal content-->
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">&times;</button>
        <h4 class="modal-title">Sistema:</h4>
      </div>
      <div class="modal-body">
        <p>Por favor, selecione o sistema em que o script ser√° aplicado </p>
        <%= bootstrap_form_for(@workplace) do |f| %>
            <% if @workplace.errors.any? %>
                <div id="error_explanation">
                  <h2><%= pluralize(@workplace.errors.count, "error") %> prohibited this workplace from being
                    saved:</h2>
                  <ul>
                    <% @workplace.errors.full_messages.each do |message| %>
                        <li><%= message %></li>
                    <% end %>
                  </ul>
                </div>
            <% end %>
            <%= f.collection_select :system_id, System.all, :id, :name, {prompt: "Please Select ..."}, {label: "Choose Sistem:"} %>
            <%= f.text_field :system_number, label: 'System Number:', class: 'form-control' %>
        <% end %>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
      </div>
    </div>

  </div>
</div>